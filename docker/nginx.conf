server {
    listen 80;
    server_name localhost;
    
    # Main document root
    root /usr/share/nginx/html;
    index index.html README.md;
    
    # Enable gzip compression
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;
    
    # Security headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    
    # Main location
    location / {
        try_files $uri $uri/ /README.md;
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
    }
    
    # Static assets
    location /assets/ {
        expires 1d;
        add_header Cache-Control "public, immutable";
    }
    
    # Documentation
    location /doc/ {
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
    }
    
    # Build artifacts
    location /build/ {
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
    }
    
    # Emscripten builds (if available)
    location /build/emscripten/ {
        # WASM MIME type
        location ~* \.wasm$ {
            add_header Content-Type application/wasm;
            expires 1d;
        }
        
        # Enable CORS for WebAssembly
        add_header Cross-Origin-Embedder-Policy require-corp;
        add_header Cross-Origin-Opener-Policy same-origin;
    }
    
    # Prevent access to sensitive files
    location ~ /\. {
        deny all;
    }
    
    location ~* \.(git|svn|hg)$ {
        deny all;
    }
    
    # Error pages
    error_page 404 /404.html;
    error_page 500 502 503 504 /50x.html;
    
    location = /50x.html {
        root /usr/share/nginx/html;
    }
}
